<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Get Products Via AJAX</title>
<link rel="stylesheet" type="text/css" href="jqueryui/css/smoothness/jquery-ui-1.8.23.custom.css">
</head>

<body>
<table>
	<thead>
    	<tr>
        	<th>Product Name</th>
            <th>Wholesale</th>
        </tr>
    </thead>
	<tbody>
    
    </tbody>
</table>

<div id="details">
	<p id="description"></p>
    <p id="quantity"></p>
    <p id="vendor"></p>
</div>



<script src="jqueryui/js/jquery-1.8.0.min.js"></script>

<script src="jqueryui/js/jquery-ui-1.8.23.custom.min.js"></script>

<script>
$(document).ready(function(e) {
	
	$('#details').dialog({
		autoOpen:false,
		modal:true
	});

    $.ajax({
		url:'getProducts.php',
		type:'get',
		dataType:'json',
		success:function(data){
			//console.log(data);
			$('table').hide();
			var numItems = data.length;
			for(var i=0 ; i <numItems ; i++){
				var rowStr = '<tr>';
				rowStr += '<td><a href="#" data-code="'+data[i].productCode+'">' + data[i].productName + '</a></td>';
				rowStr += '<td>' + Number(data[i].buyPrice).toFixed(2) + '</td>';
				rowStr += '</tr>';
				$('table tbody').append(rowStr);
			}
			$('table').fadeIn();
		},
		error:function(x,m,c){console.log(m)}
		
	});
	
	
	
	$('table').on('click','a',function(e) {
		e.preventDefault();
        //console.log($(this).attr('data-code'));
		$.ajax({
			url:'getProductByID.php',
			type:'get',
			dataType:'json',
			data:{"productCode":$(this).attr('data-code')},
			success: function(data){
				//console.log(data);
				$('#description').html(data[0].productDescription);
				$('#vendor').html(data[0].productVendor);
				$('#quantity').html(data[0].quantityInStock);
				$('#details').dialog('open');
				$('#details').dialog({title:data[0].productName})
			}
		});
    });
	
	
});
</script>


</body>
</html>
